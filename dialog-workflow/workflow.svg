<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Pages: 1 -->
<svg width="1166pt" height="892pt"
 viewBox="0.00 0.00 1166.00 892.12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 888.12)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-888.12 1162,-888.12 1162,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_memory</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="457,-8 457,-161.12 1150,-161.12 1150,-8 457,-8"/>
<text text-anchor="middle" x="803.5" y="-145.93" font-family="Times New Roman,serif" font-size="14.00">Memory Architecture</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_main</title>
<polygon fill="none" stroke="black" points="8,-47.06 8,-844.62 436,-844.62 436,-47.06 8,-47.06"/>
</g>
<g id="clust3" class="cluster">
<title>cluster_therapy</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="446,-635.12 446,-876.12 710,-876.12 710,-635.12 446,-635.12"/>
<text text-anchor="middle" x="578" y="-860.92" font-family="Times New Roman,serif" font-size="14.00">Psychological Support Flow</text>
</g>
<!-- wm -->
<g id="node1" class="node">
<title>wm</title>
<path fill="#e1f5fe" stroke="black" d="M623,-119.8C623,-125.53 587.59,-130.19 544,-130.19 500.41,-130.19 465,-125.53 465,-119.8 465,-119.8 465,-26.32 465,-26.32 465,-20.59 500.41,-15.94 544,-15.94 587.59,-15.94 623,-20.59 623,-26.32 623,-26.32 623,-119.8 623,-119.8"/>
<path fill="none" stroke="black" d="M623,-119.8C623,-114.07 587.59,-109.41 544,-109.41 500.41,-109.41 465,-114.07 465,-119.8"/>
<text text-anchor="middle" x="544" y="-99.36" font-family="Times New Roman,serif" font-size="14.00">Working Memory</text>
<text text-anchor="middle" x="544" y="-84.36" font-family="Times New Roman,serif" font-size="14.00">(RAM)</text>
<text text-anchor="middle" x="544" y="-69.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Current session context</text>
<text text-anchor="middle" x="544" y="-54.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Emotion analysis results</text>
<text text-anchor="middle" x="544" y="-39.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Dialogue state</text>
</g>
<!-- sm -->
<g id="node2" class="node">
<title>sm</title>
<path fill="#e1f5fe" stroke="black" d="M1141.5,-119.8C1141.5,-125.53 1098.25,-130.19 1045,-130.19 991.75,-130.19 948.5,-125.53 948.5,-119.8 948.5,-119.8 948.5,-26.32 948.5,-26.32 948.5,-20.59 991.75,-15.94 1045,-15.94 1098.25,-15.94 1141.5,-20.59 1141.5,-26.32 1141.5,-26.32 1141.5,-119.8 1141.5,-119.8"/>
<path fill="none" stroke="black" d="M1141.5,-119.8C1141.5,-114.07 1098.25,-109.41 1045,-109.41 991.75,-109.41 948.5,-114.07 948.5,-119.8"/>
<text text-anchor="middle" x="1045" y="-99.36" font-family="Times New Roman,serif" font-size="14.00">Semantic Memory</text>
<text text-anchor="middle" x="1045" y="-84.36" font-family="Times New Roman,serif" font-size="14.00">(PubMed Psychology Abstracts)</text>
<text text-anchor="middle" x="1045" y="-69.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Psychological knowledge base</text>
<text text-anchor="middle" x="1045" y="-54.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Therapy techniques</text>
<text text-anchor="middle" x="1045" y="-39.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Case studies</text>
</g>
<!-- em -->
<g id="node3" class="node">
<title>em</title>
<path fill="#e1f5fe" stroke="black" d="M862.5,-119.8C862.5,-125.53 828.21,-130.19 786,-130.19 743.79,-130.19 709.5,-125.53 709.5,-119.8 709.5,-119.8 709.5,-26.32 709.5,-26.32 709.5,-20.59 743.79,-15.94 786,-15.94 828.21,-15.94 862.5,-20.59 862.5,-26.32 862.5,-26.32 862.5,-119.8 862.5,-119.8"/>
<path fill="none" stroke="black" d="M862.5,-119.8C862.5,-114.07 828.21,-109.41 786,-109.41 743.79,-109.41 709.5,-114.07 709.5,-119.8"/>
<text text-anchor="middle" x="786" y="-99.36" font-family="Times New Roman,serif" font-size="14.00">Episodic Memory</text>
<text text-anchor="middle" x="786" y="-84.36" font-family="Times New Roman,serif" font-size="14.00">(MongoDB)</text>
<text text-anchor="middle" x="786" y="-69.36" font-family="Times New Roman,serif" font-size="14.00">&#45; User profiles</text>
<text text-anchor="middle" x="786" y="-54.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Historical emotion data</text>
<text text-anchor="middle" x="786" y="-39.36" font-family="Times New Roman,serif" font-size="14.00">&#45; Dialogue records</text>
</g>
<!-- start -->
<g id="node4" class="node">
<title>start</title>
<path fill="#e8f5e9" stroke="black" d="M353,-836.62C353,-836.62 251,-836.62 251,-836.62 245,-836.62 239,-830.62 239,-824.62 239,-824.62 239,-812.62 239,-812.62 239,-806.62 245,-800.62 251,-800.62 251,-800.62 353,-800.62 353,-800.62 359,-800.62 365,-806.62 365,-812.62 365,-812.62 365,-824.62 365,-824.62 365,-830.62 359,-836.62 353,-836.62"/>
<text text-anchor="middle" x="302" y="-814.92" font-family="Arial" font-size="14.00">User Access Point</text>
</g>
<!-- auth -->
<g id="node5" class="node">
<title>auth</title>
<path fill="#e8f5e9" stroke="black" d="M366,-755.12C366,-755.12 238,-755.12 238,-755.12 232,-755.12 226,-749.12 226,-743.12 226,-743.12 226,-729.12 226,-729.12 226,-723.12 232,-717.12 238,-717.12 238,-717.12 366,-717.12 366,-717.12 372,-717.12 378,-723.12 378,-729.12 378,-729.12 378,-743.12 378,-743.12 378,-749.12 372,-755.12 366,-755.12"/>
<text text-anchor="middle" x="302" y="-739.92" font-family="Arial" font-size="14.00">Login/Registration</text>
<text text-anchor="middle" x="302" y="-724.92" font-family="Arial" font-size="14.00">(Verify with MongoDB)</text>
</g>
<!-- start&#45;&gt;auth -->
<g id="edge1" class="edge">
<title>start&#45;&gt;auth</title>
<path fill="none" stroke="black" d="M302,-800.32C302,-800.32 302,-765.24 302,-765.24"/>
<polygon fill="black" stroke="black" points="305.5,-765.24 302,-755.24 298.5,-765.24 305.5,-765.24"/>
</g>
<!-- load_data -->
<g id="node6" class="node">
<title>load_data</title>
<path fill="#e8f5e9" stroke="black" d="M355.5,-680.12C355.5,-680.12 248.5,-680.12 248.5,-680.12 242.5,-680.12 236.5,-674.12 236.5,-668.12 236.5,-668.12 236.5,-654.12 236.5,-654.12 236.5,-648.12 242.5,-642.12 248.5,-642.12 248.5,-642.12 355.5,-642.12 355.5,-642.12 361.5,-642.12 367.5,-648.12 367.5,-654.12 367.5,-654.12 367.5,-668.12 367.5,-668.12 367.5,-674.12 361.5,-680.12 355.5,-680.12"/>
<text text-anchor="middle" x="302" y="-664.92" font-family="Arial" font-size="14.00">Load User Data</text>
<text text-anchor="middle" x="302" y="-649.92" font-family="Arial" font-size="14.00">(Episodic Memory)</text>
</g>
<!-- auth&#45;&gt;load_data -->
<g id="edge2" class="edge">
<title>auth&#45;&gt;load_data</title>
<path fill="none" stroke="black" d="M302,-716.81C302,-716.81 302,-690.37 302,-690.37"/>
<polygon fill="black" stroke="black" points="305.5,-690.37 302,-680.37 298.5,-690.37 305.5,-690.37"/>
</g>
<!-- multi_input -->
<g id="node7" class="node">
<title>multi_input</title>
<path fill="#e8f5e9" stroke="black" d="M402,-591.12C402,-591.12 214,-591.12 214,-591.12 208,-591.12 202,-585.12 202,-579.12 202,-579.12 202,-535.12 202,-535.12 202,-529.12 208,-523.12 214,-523.12 214,-523.12 402,-523.12 402,-523.12 408,-523.12 414,-529.12 414,-535.12 414,-535.12 414,-579.12 414,-579.12 414,-585.12 408,-591.12 402,-591.12"/>
<text text-anchor="middle" x="308" y="-575.92" font-family="Arial" font-size="14.00">Multi&#45;modal Input</text>
<text text-anchor="middle" x="308" y="-560.92" font-family="Arial" font-size="14.00">1. Voice (Wav2Vec transcription)</text>
<text text-anchor="middle" x="308" y="-545.92" font-family="Arial" font-size="14.00">2. Text input</text>
<text text-anchor="middle" x="308" y="-530.92" font-family="Arial" font-size="14.00">3. Facial expression (DeepFace)</text>
</g>
<!-- load_data&#45;&gt;multi_input -->
<g id="edge3" class="edge">
<title>load_data&#45;&gt;multi_input</title>
<path fill="none" stroke="black" d="M302,-642.05C302,-642.05 302,-601.23 302,-601.23"/>
<polygon fill="black" stroke="black" points="305.5,-601.23 302,-591.23 298.5,-601.23 305.5,-601.23"/>
</g>
<!-- emotion_analysis -->
<g id="node8" class="node">
<title>emotion_analysis</title>
<path fill="#e8f5e9" stroke="black" d="M414,-472.12C414,-472.12 202,-472.12 202,-472.12 196,-472.12 190,-466.12 190,-460.12 190,-460.12 190,-416.12 190,-416.12 190,-410.12 196,-404.12 202,-404.12 202,-404.12 414,-404.12 414,-404.12 420,-404.12 426,-410.12 426,-416.12 426,-416.12 426,-460.12 426,-460.12 426,-466.12 420,-472.12 414,-472.12"/>
<text text-anchor="middle" x="308" y="-456.93" font-family="Arial" font-size="14.00">Multi&#45;source Emotion Analysis:</text>
<text text-anchor="middle" x="308" y="-441.93" font-family="Arial" font-size="14.00">1. Voice sentiment (audio waveform)</text>
<text text-anchor="middle" x="308" y="-426.93" font-family="Arial" font-size="14.00">2. Text sentiment (transcript)</text>
<text text-anchor="middle" x="308" y="-411.93" font-family="Arial" font-size="14.00">3. Facial expression</text>
</g>
<!-- multi_input&#45;&gt;emotion_analysis -->
<g id="edge4" class="edge">
<title>multi_input&#45;&gt;emotion_analysis</title>
<path fill="none" stroke="black" d="M308,-523.02C308,-523.02 308,-482.23 308,-482.23"/>
<polygon fill="black" stroke="black" points="311.5,-482.23 308,-472.23 304.5,-482.23 311.5,-482.23"/>
</g>
<!-- emotion_analysis&#45;&gt;wm -->
<g id="edge12" class="edge">
<title>emotion_analysis&#45;&gt;wm</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M426.35,-438C485.23,-438 544,-438 544,-438 544,-438 544,-140.49 544,-140.49"/>
<polygon fill="black" stroke="black" points="547.5,-140.49 544,-130.49 540.5,-140.49 547.5,-140.49"/>
<text text-anchor="middle" x="608" y="-261.93" font-family="Times New Roman,serif" font-size="14.00">Store temp results</text>
</g>
<!-- consistency_check -->
<g id="node9" class="node">
<title>consistency_check</title>
<polygon fill="#fff3e0" stroke="black" points="242,-367.12 56,-329.12 242,-291.12 428,-329.12 242,-367.12"/>
<text text-anchor="middle" x="242" y="-332.93" font-family="Arial" font-size="14.00">Emotion Consistency Check</text>
<text text-anchor="middle" x="242" y="-317.93" font-family="Arial" font-size="14.00">(3&#45;way comparison)</text>
</g>
<!-- emotion_analysis&#45;&gt;consistency_check -->
<g id="edge5" class="edge">
<title>emotion_analysis&#45;&gt;consistency_check</title>
<path fill="none" stroke="black" d="M308,-403.94C308,-403.94 308,-363.86 308,-363.86"/>
<polygon fill="black" stroke="black" points="311.5,-363.86 308,-353.86 304.5,-363.86 311.5,-363.86"/>
</g>
<!-- handle_conflict -->
<g id="node10" class="node">
<title>handle_conflict</title>
<path fill="#e8f5e9" stroke="black" d="M415.5,-240.12C415.5,-240.12 258.5,-240.12 258.5,-240.12 252.5,-240.12 246.5,-234.12 246.5,-228.12 246.5,-228.12 246.5,-214.12 246.5,-214.12 246.5,-208.12 252.5,-202.12 258.5,-202.12 258.5,-202.12 415.5,-202.12 415.5,-202.12 421.5,-202.12 427.5,-208.12 427.5,-214.12 427.5,-214.12 427.5,-228.12 427.5,-228.12 427.5,-234.12 421.5,-240.12 415.5,-240.12"/>
<text text-anchor="middle" x="337" y="-224.93" font-family="Arial" font-size="14.00">Resolve Emotion Conflicts</text>
<text text-anchor="middle" x="337" y="-209.93" font-family="Arial" font-size="14.00">(Store in Episodic Memory)</text>
</g>
<!-- consistency_check&#45;&gt;handle_conflict -->
<g id="edge6" class="edge">
<title>consistency_check&#45;&gt;handle_conflict</title>
<path fill="none" stroke="black" d="M337,-310.31C337,-310.31 337,-250.45 337,-250.45"/>
<polygon fill="black" stroke="black" points="340.5,-250.45 337,-240.45 333.5,-250.45 340.5,-250.45"/>
<text text-anchor="middle" x="323" y="-261.93" font-family="Times New Roman,serif" font-size="14.00">Inconsistent</text>
</g>
<!-- therapy -->
<g id="node11" class="node">
<title>therapy</title>
<path fill="#e8f5e9" stroke="black" d="M276,-91.06C276,-91.06 118,-91.06 118,-91.06 112,-91.06 106,-85.06 106,-79.06 106,-79.06 106,-67.06 106,-67.06 106,-61.06 112,-55.06 118,-55.06 118,-55.06 276,-55.06 276,-55.06 282,-55.06 288,-61.06 288,-67.06 288,-67.06 288,-79.06 288,-79.06 288,-85.06 282,-91.06 276,-91.06"/>
<text text-anchor="middle" x="197" y="-69.36" font-family="Arial" font-size="14.00">Psychological Support Flow</text>
</g>
<!-- consistency_check&#45;&gt;therapy -->
<g id="edge7" class="edge">
<title>consistency_check&#45;&gt;therapy</title>
<path fill="none" stroke="black" d="M176.25,-304.11C176.25,-304.11 176.25,-101.1 176.25,-101.1"/>
<polygon fill="black" stroke="black" points="179.75,-101.1 176.25,-91.1 172.75,-101.1 179.75,-101.1"/>
<text text-anchor="middle" x="131" y="-217.43" font-family="Times New Roman,serif" font-size="14.00">Consistent</text>
</g>
<!-- handle_conflict&#45;&gt;em -->
<g id="edge15" class="edge">
<title>handle_conflict&#45;&gt;em</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M427.59,-221C552,-221 760.5,-221 760.5,-221 760.5,-221 760.5,-140.26 760.5,-140.26"/>
<polygon fill="black" stroke="black" points="764,-140.26 760.5,-130.26 757,-140.26 764,-140.26"/>
<text text-anchor="middle" x="737" y="-172.93" font-family="Times New Roman,serif" font-size="14.00">Persist conflict</text>
</g>
<!-- handle_conflict&#45;&gt;therapy -->
<g id="edge8" class="edge">
<title>handle_conflict&#45;&gt;therapy</title>
<path fill="none" stroke="black" d="M267.25,-202.07C267.25,-202.07 267.25,-101.12 267.25,-101.12"/>
<polygon fill="black" stroke="black" points="270.75,-101.12 267.25,-91.12 263.75,-101.12 270.75,-101.12"/>
</g>
<!-- retrieve -->
<g id="node12" class="node">
<title>retrieve</title>
<path fill="#e8f5e9" stroke="black" d="M689.5,-845.12C689.5,-845.12 498.5,-845.12 498.5,-845.12 492.5,-845.12 486.5,-839.12 486.5,-833.12 486.5,-833.12 486.5,-804.12 486.5,-804.12 486.5,-798.12 492.5,-792.12 498.5,-792.12 498.5,-792.12 689.5,-792.12 689.5,-792.12 695.5,-792.12 701.5,-798.12 701.5,-804.12 701.5,-804.12 701.5,-833.12 701.5,-833.12 701.5,-839.12 695.5,-845.12 689.5,-845.12"/>
<text text-anchor="middle" x="594" y="-829.92" font-family="Arial" font-size="14.00">Retrieve from:</text>
<text text-anchor="middle" x="594" y="-814.92" font-family="Arial" font-size="14.00">&#45; Semantic Memory (PubMed)</text>
<text text-anchor="middle" x="594" y="-799.92" font-family="Arial" font-size="14.00">&#45; Episodic Memory (User history)</text>
</g>
<!-- retrieve&#45;&gt;sm -->
<g id="edge13" class="edge">
<title>retrieve&#45;&gt;sm</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M701.74,-827C835.15,-827 1045,-827 1045,-827 1045,-827 1045,-140.35 1045,-140.35"/>
<polygon fill="black" stroke="black" points="1048.5,-140.35 1045,-130.35 1041.5,-140.35 1048.5,-140.35"/>
<text text-anchor="middle" x="1073.5" y="-493.93" font-family="Times New Roman,serif" font-size="14.00">Knowledge query</text>
</g>
<!-- retrieve&#45;&gt;em -->
<g id="edge14" class="edge">
<title>retrieve&#45;&gt;em</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M701.79,-809C756.49,-809 811.5,-809 811.5,-809 811.5,-809 811.5,-140.2 811.5,-140.2"/>
<polygon fill="black" stroke="black" points="815,-140.2 811.5,-130.2 808,-140.2 815,-140.2"/>
<text text-anchor="middle" x="870" y="-493.93" font-family="Times New Roman,serif" font-size="14.00">History query</text>
</g>
<!-- generate -->
<g id="node13" class="node">
<title>generate</title>
<path fill="#e8f5e9" stroke="black" d="M654.5,-755.12C654.5,-755.12 525.5,-755.12 525.5,-755.12 519.5,-755.12 513.5,-749.12 513.5,-743.12 513.5,-743.12 513.5,-729.12 513.5,-729.12 513.5,-723.12 519.5,-717.12 525.5,-717.12 525.5,-717.12 654.5,-717.12 654.5,-717.12 660.5,-717.12 666.5,-723.12 666.5,-729.12 666.5,-729.12 666.5,-743.12 666.5,-743.12 666.5,-749.12 660.5,-755.12 654.5,-755.12"/>
<text text-anchor="middle" x="590" y="-739.92" font-family="Arial" font-size="14.00">Generate Response</text>
<text text-anchor="middle" x="590" y="-724.92" font-family="Arial" font-size="14.00">(LangChain + OpenAI)</text>
</g>
<!-- retrieve&#45;&gt;generate -->
<g id="edge9" class="edge">
<title>retrieve&#45;&gt;generate</title>
<path fill="none" stroke="black" d="M590,-792.07C590,-792.07 590,-765.31 590,-765.31"/>
<polygon fill="black" stroke="black" points="593.5,-765.31 590,-755.31 586.5,-765.31 593.5,-765.31"/>
</g>
<!-- decide -->
<g id="node14" class="node">
<title>decide</title>
<polygon fill="#fff3e0" stroke="black" points="578,-679.12 453.83,-661.12 578,-643.12 702.17,-661.12 578,-679.12"/>
<text text-anchor="middle" x="578" y="-657.42" font-family="Arial" font-size="14.00">Continue Dialogue?</text>
</g>
<!-- generate&#45;&gt;decide -->
<g id="edge10" class="edge">
<title>generate&#45;&gt;decide</title>
<path fill="none" stroke="black" d="M590,-716.81C590,-716.81 590,-687.58 590,-687.58"/>
<polygon fill="black" stroke="black" points="593.5,-687.58 590,-677.58 586.5,-687.58 593.5,-687.58"/>
</g>
<!-- decide&#45;&gt;multi_input -->
<g id="edge11" class="edge">
<title>decide&#45;&gt;multi_input</title>
<path fill="none" stroke="black" d="M454.59,-661C422.13,-661 396,-661 396,-661 396,-661 396,-601.14 396,-601.14"/>
<polygon fill="black" stroke="black" points="399.5,-601.14 396,-591.14 392.5,-601.14 399.5,-601.14"/>
<text text-anchor="middle" x="497.5" y="-612.92" font-family="Times New Roman,serif" font-size="14.00">Yes</text>
</g>
</g>
</svg>
